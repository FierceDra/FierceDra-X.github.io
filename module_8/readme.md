![Авто](https://demotivation.ru/wp-content/uploads/2020/10/c3c70dfaaf031be7f2b2cac82ed87ce8.jpg)

# **Проект распознавания модели автомобиля по его фотографии. Module 8 SkillFactory**
__________________________________________________________________________________________________________________

**Проект состоит из трех частей:**
> - Часть 1 проекта - сбор дополнительных фотографий автомобилей с сайтов [auto.ru](https://auto.ru/) и  [drom.ru](https://drom.ru/). Код Части 1 находится в файле Parsing_pictures.ipynb;
> - Часть 2 проекта - создание модели нейронной сети, определяющей модель автомобиля по его фотографии. Код Части 2 находится в файле cars.ipynb;
> - Часть 3 проекта - внедрение модели в production (создание прототипа приложения на базе streamlit). Ключевые файлы прототипа находятся в папке cars_docker;

## **1. Сбор дополнительный фотографий**

В этом блоке выполнялись следующие задачи:
- [ ] сбор дополнительных фотографий автомобилей с сайтов [auto.ru](https://auto.ru/) и  [drom.ru](https://drom.ru/) с помощью библотек request и bs4;
- [ ] код парсинга можно найти в блокноте Parsing_pictures.ipynb;
- [ ] фото авто собирались сбалансированно по 10 классам;
- [ ] общее фото, на которых можно тренировать нейросеть расширилось до 24 059 фотографий;

:arrow_up: [Содержание](#вверх)

## **2. Создание модели нейронной сети**
В этом блоке выполнялись следующие задачи:
- [ ] все нейронные сети тренировались на расширенном датасете
- [ ] [в среде colab](https://drive.google.com/file/d/1Yee4JIviy1cVXitgPMmBCoZqvLeAnTxG/view?usp=sharing) были выполнены следующие варианты создания нейронной сверточной сети для распознавания фотографий авто:
- [ ] Была создана собственная нейронная сеть на базе архитектуры Xception;
- [ ] были проведены разные эксперименты с собственной нейронной сетью, в том числе с изменением ее архитектуры (вставлялись блоке SE-ResNet, а также добалялись shorcuts);
- [ ] Далее было проведено моделирование с использованием сети Xception с весами от imagenet;
- [ ] Далее было проведено моделирование с использованием сети EfficientnetB3 с весами от imagenet;
- [ ] Далее было проведено моделирование с использованием Transfer Learning;
- [ ] Далее было проведено моделирование с использованием tta;
- [ ] Результаты каждого моделирования тестировались на Kaggle, итоговый результат: 97,63% с использованием сети EfficientnetB3.

## **3. Создание прототипа приложения**

В этом блоке выполнялись следующие задачи:
- [ ] на первом шаге был создан исполнительный файл cars.py, в котром с использованием модуля streamlit был написан исполнительный код прототипа;
- [ ] код выполняет загрузку фотографий автомобиля на сайте в формате jpg и прогноку его через модель Xception, получая результат прогнозирования и выводя на сайт фото авто и его модель;
- [ ] далее был создан файл requirements.txt, фиксирующий среду исполнения файла;
- [ ] далее был создан файл Dockerfile с целью упаковки прототипа в контейнер на облаке AWS (Amzon);
- [ ] файл Dockerrun.json  - это специальный файл для развертывания приложения на облаке AWS в среде ElasticBeanstalk;
- [ ] сама модель Xception, натренированная на расширенном датасете (дополненным скачанными с авто и дром ру фото), находится в файле model_xc.h5;
- [ ] файл model_xc.h5 весит больше 100 MB, поэтому не представлен здесь. Его можно найти в гугл диске по ссылке https://drive.google.com/drive/folders/1VKQVHc_EHF2fLn1mx6YgIXl1UDcftpjn?usp=sharing;
- [ ] на удаленной виртуальной машине AWS в среде Linux был создан docker image и загружен на docker hub, а затем в среде Elasticbeanstalk был развернут прототип;
- [ ] прототип доступен по ссылке [прототип cars](http://cars-env.eba-b3jhni8h.us-east-2.elasticbeanstalk.com/)
